{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { createContext, useState, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport axios from 'axios';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { API_URL } from \"../config\";\nimport { login as apiLogin, register as apiRegister } from \"../services/api\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userToken = _useState4[0],\n    setUserToken = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    userInfo = _useState6[0],\n    setUserInfo = _useState6[1];\n  var login = function () {\n    var _ref2 = _asyncToGenerator(function* (email, password) {\n      try {\n        setIsLoading(true);\n        if (!email || !password) {\n          return {\n            success: false,\n            message: 'Please enter both email and password.'\n          };\n        }\n        try {\n          var userData = yield apiLogin({\n            email: email,\n            password: password\n          });\n          console.log('Login API response successful:', userData);\n          if (!userData.user) {\n            userData.user = {\n              _id: userData._id,\n              name: userData.name,\n              email: userData.email,\n              profileImage: userData.profileImage,\n              isPremium: userData.isPremium,\n              createdAt: userData.createdAt || new Date().toISOString()\n            };\n          }\n          if (!userData.user.createdAt) {\n            userData.user.createdAt = new Date().toISOString();\n          }\n          setUserInfo(userData.user);\n          setUserToken(userData.token);\n          yield AsyncStorage.setItem('userInfo', JSON.stringify(userData.user));\n          yield AsyncStorage.setItem('userToken', userData.token);\n          return {\n            success: true,\n            data: userData.user\n          };\n        } catch (apiError) {\n          console.log('API login error, falling back to demo mode:', apiError);\n          var isValidCredentials = email === 'user@example.com' && password === 'password' || email === 'test123@example.com' && password === 'password' || email === 'test@gmail.com' && password === 'password';\n          if (!isValidCredentials) {\n            return {\n              success: false,\n              message: 'Invalid email or password.'\n            };\n          }\n          var demoUser = {\n            _id: 'user_123',\n            name: 'Regular User',\n            email: email,\n            token: 'demo_token_' + Date.now(),\n            profileImage: null,\n            isPremium: true\n          };\n          if (email === 'test123@example.com') {\n            demoUser = _objectSpread(_objectSpread({}, demoUser), {}, {\n              _id: 'user_test123',\n              name: 'Test 123',\n              email: 'test123@example.com'\n            });\n          }\n          if (email === 'test@gmail.com') {\n            demoUser = _objectSpread(_objectSpread({}, demoUser), {}, {\n              _id: 'user_gmail',\n              name: 'Test Gmail',\n              email: 'test@gmail.com'\n            });\n          }\n          setUserInfo(demoUser);\n          setUserToken(demoUser.token);\n          yield AsyncStorage.setItem('userInfo', JSON.stringify(demoUser));\n          yield AsyncStorage.setItem('userToken', demoUser.token);\n          console.log('Login successful (demo mode):', demoUser.name);\n          return {\n            success: true,\n            data: demoUser\n          };\n        }\n      } catch (error) {\n        var _error$response, _error$response$data;\n        console.log('Login error:', error);\n        return {\n          success: false,\n          message: ((_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.message) || 'Login failed. Please try again.'\n        };\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function login(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var register = function () {\n    var _ref3 = _asyncToGenerator(function* (userData) {\n      try {\n        setUserInfo(null);\n        setUserToken(null);\n        setIsLoading(true);\n        try {\n          var response = yield apiRegister(userData);\n          console.log('Registration API response successful:', response);\n          setUserInfo(response.user);\n          setUserToken(response.token);\n          yield AsyncStorage.setItem('userInfo', JSON.stringify(response.user));\n          yield AsyncStorage.setItem('userToken', response.token);\n          return {\n            success: true,\n            data: response\n          };\n        } catch (apiError) {\n          console.log('API registration error, falling back to demo mode:', apiError);\n          if (userData.email === 'test@example.com') {\n            return {\n              success: false,\n              message: 'This email is already registered. Please use a different email or login.'\n            };\n          }\n          var newUser = {\n            _id: `user_${Date.now()}`,\n            name: userData.name,\n            email: userData.email,\n            phone: userData.phone || null,\n            createdAt: new Date().toISOString(),\n            isPremium: false\n          };\n          return {\n            success: true,\n            data: newUser\n          };\n        }\n      } catch (error) {\n        var _error$response2, _error$response2$data;\n        console.log('Registration Error: ', error);\n        return {\n          success: false,\n          message: ((_error$response2 = error.response) == null ? void 0 : (_error$response2$data = _error$response2.data) == null ? void 0 : _error$response2$data.message) || 'Registration failed. Please try again.'\n        };\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function register(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var logout = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      try {\n        console.log('AuthContext: Starting logout process');\n        setIsLoading(true);\n        console.log('AuthContext: Clearing context state...');\n        setUserToken(null);\n        setUserInfo(null);\n        console.log('AuthContext: Clearing AsyncStorage...');\n        try {\n          yield AsyncStorage.removeItem('userInfo');\n          console.log('AuthContext: Removed userInfo from AsyncStorage');\n        } catch (storageError) {\n          console.error('AuthContext: Failed to remove userInfo from AsyncStorage:', storageError);\n        }\n        try {\n          yield AsyncStorage.removeItem('userToken');\n          console.log('AuthContext: Removed userToken from AsyncStorage');\n        } catch (storageError) {\n          console.error('AuthContext: Failed to remove userToken from AsyncStorage:', storageError);\n        }\n        var checkUserInfo = yield AsyncStorage.getItem('userInfo');\n        var checkUserToken = yield AsyncStorage.getItem('userToken');\n        if (checkUserInfo || checkUserToken) {\n          console.warn('AuthContext: Some items may not have been fully removed from AsyncStorage');\n        } else {\n          console.log('AuthContext: Successfully verified AsyncStorage items were removed');\n        }\n        console.log('AuthContext: Logout successful - all user data cleared');\n        return true;\n      } catch (error) {\n        console.error('AuthContext: Logout error:', error);\n        setUserToken(null);\n        setUserInfo(null);\n        Alert.alert('Logout Error', 'There was a problem logging out. Please try again.');\n        return false;\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function logout() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var upgradeToPremium = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      setIsLoading(true);\n      try {\n        var wasOnTrial = userInfo == null ? void 0 : userInfo.trialActive;\n        var updatedUserInfo = _objectSpread(_objectSpread({}, userInfo), {}, {\n          isPremium: true,\n          premiumSince: new Date().toISOString(),\n          trialActive: false,\n          trialStartDate: null,\n          trialEndDate: null\n        });\n        setUserInfo(updatedUserInfo);\n        yield AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n        return {\n          success: true,\n          message: wasOnTrial ? 'Your trial has been converted to a premium subscription.' : 'Your account has been upgraded to premium!'\n        };\n      } catch (error) {\n        var _error$response3, _error$response3$data;\n        console.log('Upgrade error:', error);\n        return {\n          success: false,\n          message: ((_error$response3 = error.response) == null ? void 0 : (_error$response3$data = _error$response3.data) == null ? void 0 : _error$response3$data.message) || 'An error occurred during upgrade'\n        };\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function upgradeToPremium() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var cancelPremium = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      setIsLoading(true);\n      try {\n        var wasOnTrial = userInfo == null ? void 0 : userInfo.trialActive;\n        var updatedUserInfo = _objectSpread(_objectSpread({}, userInfo), {}, {\n          isPremium: false,\n          premiumSince: null,\n          trialActive: false,\n          trialStartDate: null,\n          trialEndDate: null\n        });\n        setUserInfo(updatedUserInfo);\n        yield AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n        return {\n          success: true,\n          message: wasOnTrial ? 'Your free trial has been cancelled. No charges will be made.' : 'Your premium subscription has been cancelled.'\n        };\n      } catch (error) {\n        var _error$response4, _error$response4$data;\n        console.log('Cancellation error:', error);\n        return {\n          success: false,\n          message: ((_error$response4 = error.response) == null ? void 0 : (_error$response4$data = _error$response4.data) == null ? void 0 : _error$response4$data.message) || 'An error occurred while canceling'\n        };\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function cancelPremium() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var isLoggedIn = function () {\n    var _ref7 = _asyncToGenerator(function* () {\n      try {\n        setIsLoading(true);\n        var _userInfo = yield AsyncStorage.getItem('userInfo');\n        var _userToken = yield AsyncStorage.getItem('userToken');\n        if (_userInfo) {\n          _userInfo = JSON.parse(_userInfo);\n          setUserInfo(_userInfo);\n          setUserToken(_userToken);\n        }\n      } catch (error) {\n        console.log(error);\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function isLoggedIn() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n  var requireLogin = function requireLogin(navigation) {\n    if (!userToken) {\n      Alert.alert('Login Required', 'You need to log in to access this feature', [{\n        text: 'Cancel',\n        style: 'cancel'\n      }, {\n        text: 'Login',\n        onPress: function onPress() {\n          return navigation.navigate('Login');\n        }\n      }]);\n      return false;\n    }\n    return true;\n  };\n  var checkPhoneEligibleForTrial = function () {\n    var _ref8 = _asyncToGenerator(function* (phone) {\n      if (!phone || phone.trim() === '') {\n        return {\n          eligible: false,\n          message: 'Phone number is required for free trial'\n        };\n      }\n      return {\n        eligible: true,\n        message: 'Phone number is eligible for free trial'\n      };\n    });\n    return function checkPhoneEligibleForTrial(_x4) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n  var startFreeTrial = function () {\n    var _ref9 = _asyncToGenerator(function* (phone) {\n      try {\n        setIsLoading(true);\n        var phoneCheck = yield checkPhoneEligibleForTrial(phone);\n        if (!phoneCheck.eligible) {\n          return {\n            success: false,\n            message: phoneCheck.message\n          };\n        }\n        var trialStartDate = new Date();\n        var trialEndDate = new Date();\n        trialEndDate.setDate(trialEndDate.getDate() + 3);\n        var updatedUserInfo = _objectSpread(_objectSpread({}, userInfo), {}, {\n          trialActive: true,\n          trialStartDate: trialStartDate.toISOString(),\n          trialEndDate: trialEndDate.toISOString(),\n          phone: phone || (userInfo == null ? void 0 : userInfo.phone)\n        });\n        setUserInfo(updatedUserInfo);\n        yield AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n        return {\n          success: true,\n          message: 'Your 3-day free trial has started! You will be billed $10 after the trial period unless you cancel.',\n          trialEndDate: trialEndDate.toISOString()\n        };\n      } catch (error) {\n        console.log('Error starting trial:', error);\n        return {\n          success: false,\n          message: 'Failed to start free trial. Please try again later.'\n        };\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function startFreeTrial(_x5) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n  var checkTrialStatus = function checkTrialStatus() {\n    if (!(userInfo != null && userInfo.trialActive)) {\n      return {\n        active: false\n      };\n    }\n    var now = new Date();\n    var trialEnd = new Date(userInfo.trialEndDate);\n    if (now > trialEnd) {\n      return {\n        active: false,\n        expired: true,\n        message: 'Your free trial has expired. Please upgrade to continue accessing premium features.'\n      };\n    }\n    var diffTime = Math.abs(trialEnd - now);\n    var diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    return {\n      active: true,\n      daysRemaining: diffDays,\n      trialEndDate: userInfo.trialEndDate,\n      message: `Your free trial is active. ${diffDays} days remaining.`\n    };\n  };\n  var canAccessPremiumFeatures = function canAccessPremiumFeatures() {\n    if (userInfo != null && userInfo.isPremium) return {\n      access: true,\n      reason: 'premium'\n    };\n    var trialStatus = checkTrialStatus();\n    if (trialStatus.active) return {\n      access: true,\n      reason: 'trial'\n    };\n    return {\n      access: false,\n      reason: trialStatus.expired ? 'trial_expired' : 'not_premium'\n    };\n  };\n  var getUserSubscriptionStatus = function getUserSubscriptionStatus() {\n    if (!userInfo) return {\n      status: 'guest'\n    };\n    if (userInfo.isPremium) {\n      return {\n        status: 'premium',\n        since: userInfo.premiumSince,\n        displayText: 'Premium Member'\n      };\n    }\n    var trialStatus = checkTrialStatus();\n    if (trialStatus.active) {\n      return {\n        status: 'trial',\n        daysRemaining: trialStatus.daysRemaining,\n        endDate: trialStatus.trialEndDate,\n        displayText: `Trial (${trialStatus.daysRemaining} days left)`\n      };\n    }\n    if (trialStatus.expired) {\n      return {\n        status: 'expired',\n        displayText: 'Trial Expired'\n      };\n    }\n    return {\n      status: 'regular',\n      displayText: 'Regular Account'\n    };\n  };\n  var updateUserProfile = function () {\n    var _ref10 = _asyncToGenerator(function* (profileData) {\n      try {\n        var token = yield AsyncStorage.getItem('userToken');\n        if (!token) {\n          throw new Error('Authentication required');\n        }\n        setIsLoading(true);\n        var formData = new FormData();\n        formData.append('name', profileData.name || '');\n        formData.append('bio', profileData.bio || '');\n        if (profileData.interests && profileData.interests.length > 0) {\n          formData.append('interests', JSON.stringify(profileData.interests));\n        }\n        if (profileData.profileImage && profileData.profileImage.startsWith('file://')) {\n          var uriParts = profileData.profileImage.split('.');\n          var fileType = uriParts[uriParts.length - 1];\n          formData.append('profileImage', {\n            uri: profileData.profileImage,\n            name: `profile-${userInfo._id}.${fileType}`,\n            type: `image/${fileType}`\n          });\n        }\n        var updatedUserInfo = _objectSpread(_objectSpread({}, userInfo), {}, {\n          name: profileData.name || userInfo.name,\n          bio: profileData.bio || userInfo.bio,\n          interests: profileData.interests || userInfo.interests,\n          profileImage: profileData.profileImage || userInfo.profileImage\n        });\n        yield AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n        setUserInfo(updatedUserInfo);\n        return {\n          success: true,\n          message: 'Profile updated successfully'\n        };\n      } catch (error) {\n        console.log('Error updating profile:', error);\n        return {\n          success: false,\n          message: error.message || 'Failed to update profile'\n        };\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function updateUserProfile(_x6) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    isLoggedIn();\n  }, []);\n  return _jsx(AuthContext.Provider, {\n    value: {\n      isLoading: isLoading,\n      userToken: userToken,\n      userInfo: userInfo,\n      login: login,\n      register: register,\n      logout: logout,\n      upgradeToPremium: upgradeToPremium,\n      cancelPremium: cancelPremium,\n      requireLogin: requireLogin,\n      setUserToken: setUserToken,\n      setUserInfo: setUserInfo,\n      startFreeTrial: startFreeTrial,\n      checkTrialStatus: checkTrialStatus,\n      canAccessPremiumFeatures: canAccessPremiumFeatures,\n      updateUserProfile: updateUserProfile,\n      getUserSubscriptionStatus: getUserSubscriptionStatus\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["React","createContext","useState","useEffect","AsyncStorage","axios","Alert","API_URL","login","apiLogin","register","apiRegister","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","userToken","setUserToken","_useState5","_useState6","userInfo","setUserInfo","_ref2","_asyncToGenerator","email","password","success","message","userData","console","log","user","_id","name","profileImage","isPremium","createdAt","Date","toISOString","token","setItem","JSON","stringify","data","apiError","isValidCredentials","demoUser","now","_objectSpread","error","_error$response","_error$response$data","response","_x","_x2","apply","arguments","_ref3","newUser","phone","_error$response2","_error$response2$data","_x3","logout","_ref4","removeItem","storageError","checkUserInfo","getItem","checkUserToken","warn","alert","upgradeToPremium","_ref5","wasOnTrial","trialActive","updatedUserInfo","premiumSince","trialStartDate","trialEndDate","_error$response3","_error$response3$data","cancelPremium","_ref6","_error$response4","_error$response4$data","isLoggedIn","_ref7","parse","requireLogin","navigation","text","style","onPress","navigate","checkPhoneEligibleForTrial","_ref8","trim","eligible","_x4","startFreeTrial","_ref9","phoneCheck","setDate","getDate","_x5","checkTrialStatus","active","trialEnd","expired","diffTime","Math","abs","diffDays","ceil","daysRemaining","canAccessPremiumFeatures","access","reason","trialStatus","getUserSubscriptionStatus","status","since","displayText","endDate","updateUserProfile","_ref10","profileData","Error","formData","FormData","append","bio","interests","length","startsWith","uriParts","split","fileType","uri","type","_x6","Provider","value"],"sources":["/Users/handy.hasan/Documents/SportsConnect/client/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport axios from 'axios';\nimport { Alert } from 'react-native';\nimport { API_URL } from '../config';\nimport { login as apiLogin, register as apiRegister } from '../services/api';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [userToken, setUserToken] = useState(null);\n  const [userInfo, setUserInfo] = useState(null);\n\n  const login = async (email, password) => {\n    try {\n      setIsLoading(true);\n      \n      // Validate input\n      if (!email || !password) {\n        return { success: false, message: 'Please enter both email and password.' };\n      }\n      \n      try {\n        // Make a real API call to the backend for authentication\n        const userData = await apiLogin({ email, password });\n        \n        console.log('Login API response successful:', userData);\n        \n        // Ensure user data is properly structured\n        if (!userData.user) {\n          userData.user = {\n            _id: userData._id,\n            name: userData.name,\n            email: userData.email,\n            profileImage: userData.profileImage,\n            isPremium: userData.isPremium,\n            createdAt: userData.createdAt || new Date().toISOString()\n          };\n        }\n        \n        // Ensure the user info has createdAt\n        if (!userData.user.createdAt) {\n          userData.user.createdAt = new Date().toISOString();\n        }\n        \n        // Save the user data and token\n        setUserInfo(userData.user);\n        setUserToken(userData.token);\n        \n        await AsyncStorage.setItem('userInfo', JSON.stringify(userData.user));\n        await AsyncStorage.setItem('userToken', userData.token);\n        \n        return { success: true, data: userData.user };\n      } catch (apiError) {\n        console.log('API login error, falling back to demo mode:', apiError);\n        \n        // DEMO MODE: For testing purposes only\n        // In a production app, you would remove this fallback\n        const isValidCredentials = \n          (email === 'user@example.com' && password === 'password') || \n          (email === 'test123@example.com' && password === 'password') ||\n          (email === 'test@gmail.com' && password === 'password');\n        \n        if (!isValidCredentials) {\n          return { success: false, message: 'Invalid email or password.' };\n        }\n        \n        // Create demo user based on email\n        let demoUser = {\n          _id: 'user_123',\n          name: 'Regular User',\n          email: email,\n          token: 'demo_token_' + Date.now(), // Simple token for demo\n          profileImage: null,\n          isPremium: true, // Set everyone to premium for now to enable chat\n        };\n        \n        // Special case for test123 user\n        if (email === 'test123@example.com') {\n          demoUser = {\n            ...demoUser,\n            _id: 'user_test123',\n            name: 'Test 123',\n            email: 'test123@example.com',\n          };\n        }\n        \n        // Special case for test@gmail.com\n        if (email === 'test@gmail.com') {\n          demoUser = {\n            ...demoUser,\n            _id: 'user_gmail',\n            name: 'Test Gmail',\n            email: 'test@gmail.com',\n          };\n        }\n        \n        // Store user info and token\n        setUserInfo(demoUser);\n        setUserToken(demoUser.token);\n        \n        await AsyncStorage.setItem('userInfo', JSON.stringify(demoUser));\n        await AsyncStorage.setItem('userToken', demoUser.token);\n        \n        console.log('Login successful (demo mode):', demoUser.name);\n        return { success: true, data: demoUser };\n      }\n    } catch (error) {\n      console.log('Login error:', error);\n      return {\n        success: false,\n        message: error.response?.data?.message || 'Login failed. Please try again.'\n      };\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const register = async (userData) => {\n    try {\n      // Clear state\n      setUserInfo(null);\n      setUserToken(null);\n      setIsLoading(true);\n      \n      try {\n        // Try to make a real API call\n        const response = await apiRegister(userData);\n        \n        console.log('Registration API response successful:', response);\n        \n        // Save the user data and token\n        setUserInfo(response.user);\n        setUserToken(response.token);\n        \n        await AsyncStorage.setItem('userInfo', JSON.stringify(response.user));\n        await AsyncStorage.setItem('userToken', response.token);\n        \n        return {\n          success: true,\n          data: response\n        };\n      } catch (apiError) {\n        console.log('API registration error, falling back to demo mode:', apiError);\n        \n        // Demo: Check if the email is already in use\n        if (userData.email === 'test@example.com') {\n          return {\n            success: false,\n            message: 'This email is already registered. Please use a different email or login.'\n          };\n        }\n        \n        // Demo: Create a fake user with the provided data\n        const newUser = {\n          _id: `user_${Date.now()}`,\n          name: userData.name,\n          email: userData.email,\n          phone: userData.phone || null, // Store phone if provided\n          createdAt: new Date().toISOString(),\n          isPremium: false\n        };\n        \n        return {\n          success: true,\n          data: newUser\n        };\n      }\n    } catch (error) {\n      console.log('Registration Error: ', error);\n      return {\n        success: false,\n        message: error.response?.data?.message || 'Registration failed. Please try again.'\n      };\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const logout = async () => {\n    try {\n      console.log('AuthContext: Starting logout process');\n      setIsLoading(true);\n      \n      // First clear the context state (do this first for better user experience)\n      console.log('AuthContext: Clearing context state...');\n      setUserToken(null);\n      setUserInfo(null);\n      \n      console.log('AuthContext: Clearing AsyncStorage...');\n      // Clear local storage - use a more direct approach that won't fail silently\n      try {\n        await AsyncStorage.removeItem('userInfo');\n        console.log('AuthContext: Removed userInfo from AsyncStorage');\n      } catch (storageError) {\n        console.error('AuthContext: Failed to remove userInfo from AsyncStorage:', storageError);\n      }\n      \n      try {\n        await AsyncStorage.removeItem('userToken');\n        console.log('AuthContext: Removed userToken from AsyncStorage');\n      } catch (storageError) {\n        console.error('AuthContext: Failed to remove userToken from AsyncStorage:', storageError);\n      }\n      \n      // Verify the items were removed\n      const checkUserInfo = await AsyncStorage.getItem('userInfo');\n      const checkUserToken = await AsyncStorage.getItem('userToken');\n      \n      if (checkUserInfo || checkUserToken) {\n        console.warn('AuthContext: Some items may not have been fully removed from AsyncStorage');\n      } else {\n        console.log('AuthContext: Successfully verified AsyncStorage items were removed');\n      }\n      \n      console.log('AuthContext: Logout successful - all user data cleared');\n      return true;\n    } catch (error) {\n      console.error('AuthContext: Logout error:', error);\n      // For UX, still clear the state even if there was an error with storage\n      setUserToken(null);\n      setUserInfo(null);\n      \n      Alert.alert('Logout Error', 'There was a problem logging out. Please try again.');\n      return false;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const upgradeToPremium = async () => {\n    setIsLoading(true);\n    try {\n      // For demo purposes, we'll just update the local state\n      // In a real app, this would:\n      // 1. Make an API call to process payment\n      // 2. If user was on trial, convert their account instead of charging them again\n      // 3. Set up recurring billing\n      \n      const wasOnTrial = userInfo?.trialActive;\n      \n      // Update the user info\n      const updatedUserInfo = {\n        ...userInfo,\n        isPremium: true,\n        premiumSince: new Date().toISOString(),\n        // If user was on trial, we want to clear the trial flags\n        trialActive: false,\n        trialStartDate: null,\n        trialEndDate: null\n      };\n      \n      setUserInfo(updatedUserInfo);\n      await AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n      \n      return {\n        success: true,\n        message: wasOnTrial \n          ? 'Your trial has been converted to a premium subscription.' \n          : 'Your account has been upgraded to premium!'\n      };\n    } catch (error) {\n      console.log('Upgrade error:', error);\n      return {\n        success: false,\n        message: error.response?.data?.message || 'An error occurred during upgrade'\n      };\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const cancelPremium = async () => {\n    setIsLoading(true);\n    try {\n      // For demo purposes, we'll just update the local state\n      // In a real app, this would:\n      // 1. Make an API call to cancel subscription\n      // 2. Properly handle cancelling trial vs actual subscription\n      \n      const wasOnTrial = userInfo?.trialActive;\n      \n      // Update the user info\n      const updatedUserInfo = {\n        ...userInfo,\n        isPremium: false,\n        premiumSince: null,\n        trialActive: false,\n        trialStartDate: null,\n        trialEndDate: null\n      };\n      \n      setUserInfo(updatedUserInfo);\n      await AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n      \n      return {\n        success: true,\n        message: wasOnTrial \n          ? 'Your free trial has been cancelled. No charges will be made.' \n          : 'Your premium subscription has been cancelled.'\n      };\n    } catch (error) {\n      console.log('Cancellation error:', error);\n      return {\n        success: false,\n        message: error.response?.data?.message || 'An error occurred while canceling'\n      };\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const isLoggedIn = async () => {\n    try {\n      setIsLoading(true);\n      let userInfo = await AsyncStorage.getItem('userInfo');\n      let userToken = await AsyncStorage.getItem('userToken');\n\n      if (userInfo) {\n        userInfo = JSON.parse(userInfo);\n        setUserInfo(userInfo);\n        setUserToken(userToken);\n      }\n    } catch (error) {\n      console.log(error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Function to check if user is logged in and redirect to login if not\n  const requireLogin = (navigation) => {\n    if (!userToken) {\n      Alert.alert(\n        'Login Required',\n        'You need to log in to access this feature',\n        [\n          {\n            text: 'Cancel',\n            style: 'cancel',\n          },\n          {\n            text: 'Login',\n            onPress: () => navigation.navigate('Login'),\n          },\n        ]\n      );\n      return false;\n    }\n    return true;\n  };\n\n  // Function to check if a phone number exists in the trial database\n  // In a real app, this would make an API call to check if the phone has been used for a trial\n  const checkPhoneEligibleForTrial = async (phone) => {\n    if (!phone || phone.trim() === '') {\n      return { \n        eligible: false, \n        message: 'Phone number is required for free trial'\n      };\n    }\n    \n    // For demo purposes, we'll always return true\n    // In production, you would check against a database\n    return { \n      eligible: true, \n      message: 'Phone number is eligible for free trial'\n    };\n  };\n\n  // Start a free trial for the current user\n  const startFreeTrial = async (phone) => {\n    try {\n      setIsLoading(true);\n      \n      // Verify phone number first\n      const phoneCheck = await checkPhoneEligibleForTrial(phone);\n      if (!phoneCheck.eligible) {\n        return {\n          success: false,\n          message: phoneCheck.message\n        };\n      }\n      \n      // In a real app, you would:\n      // 1. Make an API call to register the trial\n      // 2. Store payment method details for later billing\n      // 3. Set up a scheduled task to bill after trial period\n      \n      // Calculate trial end date (3 days from now)\n      const trialStartDate = new Date();\n      const trialEndDate = new Date();\n      trialEndDate.setDate(trialEndDate.getDate() + 3);\n      \n      // Update user info with trial information\n      const updatedUserInfo = {\n        ...userInfo,\n        trialActive: true,\n        trialStartDate: trialStartDate.toISOString(),\n        trialEndDate: trialEndDate.toISOString(),\n        phone: phone || userInfo?.phone, // Save phone if provided\n      };\n      \n      setUserInfo(updatedUserInfo);\n      await AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n      \n      return { \n        success: true, \n        message: 'Your 3-day free trial has started! You will be billed $10 after the trial period unless you cancel.',\n        trialEndDate: trialEndDate.toISOString()\n      };\n    } catch (error) {\n      console.log('Error starting trial:', error);\n      return {\n        success: false,\n        message: 'Failed to start free trial. Please try again later.'\n      };\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Check if user's trial is still active\n  const checkTrialStatus = () => {\n    if (!userInfo?.trialActive) {\n      return { active: false };\n    }\n    \n    const now = new Date();\n    const trialEnd = new Date(userInfo.trialEndDate);\n    \n    if (now > trialEnd) {\n      return { \n        active: false,\n        expired: true,\n        message: 'Your free trial has expired. Please upgrade to continue accessing premium features.' \n      };\n    }\n    \n    // Calculate days remaining\n    const diffTime = Math.abs(trialEnd - now);\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    \n    return { \n      active: true,\n      daysRemaining: diffDays,\n      trialEndDate: userInfo.trialEndDate,\n      message: `Your free trial is active. ${diffDays} days remaining.`\n    };\n  };\n\n  // Helper function to check if user can access premium features\n  const canAccessPremiumFeatures = () => {\n    if (userInfo?.isPremium) return { access: true, reason: 'premium' };\n    \n    const trialStatus = checkTrialStatus();\n    if (trialStatus.active) return { access: true, reason: 'trial' };\n    \n    return { \n      access: false, \n      reason: trialStatus.expired ? 'trial_expired' : 'not_premium' \n    };\n  };\n\n  // Get premium or trial status for UI display\n  const getUserSubscriptionStatus = () => {\n    if (!userInfo) return { status: 'guest' };\n    \n    if (userInfo.isPremium) {\n      return { \n        status: 'premium',\n        since: userInfo.premiumSince,\n        displayText: 'Premium Member'\n      };\n    }\n    \n    const trialStatus = checkTrialStatus();\n    if (trialStatus.active) {\n      return {\n        status: 'trial',\n        daysRemaining: trialStatus.daysRemaining,\n        endDate: trialStatus.trialEndDate,\n        displayText: `Trial (${trialStatus.daysRemaining} days left)`\n      };\n    }\n    \n    if (trialStatus.expired) {\n      return {\n        status: 'expired',\n        displayText: 'Trial Expired'\n      };\n    }\n    \n    return {\n      status: 'regular',\n      displayText: 'Regular Account'\n    };\n  };\n\n  const updateUserProfile = async (profileData) => {\n    try {\n      const token = await AsyncStorage.getItem('userToken');\n      if (!token) {\n        throw new Error('Authentication required');\n      }\n      \n      setIsLoading(true);\n      \n      // Prepare form data for profile image upload\n      const formData = new FormData();\n      \n      // Add other profile fields\n      formData.append('name', profileData.name || '');\n      formData.append('bio', profileData.bio || '');\n      \n      // Add interests as a JSON string\n      if (profileData.interests && profileData.interests.length > 0) {\n        formData.append('interests', JSON.stringify(profileData.interests));\n      }\n      \n      // Add profile image if it exists and is a new one (starts with file://)\n      if (profileData.profileImage && profileData.profileImage.startsWith('file://')) {\n        const uriParts = profileData.profileImage.split('.');\n        const fileType = uriParts[uriParts.length - 1];\n        \n        formData.append('profileImage', {\n          uri: profileData.profileImage,\n          name: `profile-${userInfo._id}.${fileType}`,\n          type: `image/${fileType}`\n        });\n      }\n      \n      // For demo purposes, just update the local user info\n      // In production, you would send formData to your API\n      const updatedUserInfo = {\n        ...userInfo,\n        name: profileData.name || userInfo.name,\n        bio: profileData.bio || userInfo.bio,\n        interests: profileData.interests || userInfo.interests,\n        profileImage: profileData.profileImage || userInfo.profileImage\n      };\n      \n      // Save to AsyncStorage\n      await AsyncStorage.setItem('userInfo', JSON.stringify(updatedUserInfo));\n      \n      // Update state\n      setUserInfo(updatedUserInfo);\n      \n      return { success: true, message: 'Profile updated successfully' };\n    } catch (error) {\n      console.log('Error updating profile:', error);\n      return { success: false, message: error.message || 'Failed to update profile' };\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    isLoggedIn();\n  }, []);\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isLoading,\n        userToken,\n        userInfo,\n        login,\n        register,\n        logout,\n        upgradeToPremium,\n        cancelPremium,\n        requireLogin,\n        setUserToken,\n        setUserInfo,\n        startFreeTrial,\n        checkTrialStatus,\n        canAccessPremiumFeatures,\n        updateUserProfile,\n        getUserSubscriptionStatus\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}